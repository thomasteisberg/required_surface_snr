# Pre-processing of CReSIS radar data

There are two main stages here:
1. Obtaining radar data
2. Calculating required surface SNR from the radar data

Step 1 is accomplished by running `data_scrapper.py` for each year and dataset (`Antarctica` or `Greenland`) you want. For example:

```
python data_scrapper.py --year=2019 --dataset Greenland
```

There are example SLURM scripts located in `data_preprocessing/slurm/get_cresis_antarctica.sh` and `data_preprocessing/slurm/get_cresis_greenland.sh` that will parallelize and automate this process. They will need to be modified for your individual setup.

Step 2 is to run `raw_to_snr.py` on each dataset:

```
python raw_to_snr.py --dataset Greenland --output snr_data_cresis_gis.csv
python raw_to_snr.py --dataset Antarctica --output snr_data_cresis_ais.csv
```

Similarly, there is an example SLURM script in `data_preprocessing/slurm/run_raw_to_snr.sh` that may be modified to suit your needs.

Once the RSSNR CSV files are generated (or otherwise obtained if available pre-generated), see `interpolate_external_datasets.ipynb` in the top level of this repository.

# Notes on suggested dataset

As a limit on how far back to go, we use data starting from the first deployments of MCoRDS (rather than MCRDS). This is 2009 in Antarctica and 2010 in Greenland, as listed in the [RDS Radar Guide](https://gitlab.com/openpolarradar/opr/-/wikis/Radar-Guide-rds). We use all versions of MCoRDS (1, 2, and 3). Data with MCoRDS is available through 2018 in Antarctica and 2019 in Greenland.

Data on the CReSIS website from Antarctica in 2022 and 2023 is from the UTIG MARFA radar. **TODO: Need to decide if we want to use or exclude this.**

Note that we exclude all ground-based data. This is setup as a filter in the data scraping scripts.

# Overview of individual files

### **1. `snr_finder.py`**

**Description:**  
This script processes radar data from `.csv` and `.mat` files to calculate the Signal-to-Noise Ratio (SNR) for each data point in the CReSIS dataset. It is robust and efficient, ideal for large geophysical radar datasets. The calculated SNR values are crucial for determining the quality and reliability of radar signals in various environments.

### **2. `comparer.py`**

**Description:**  
This script compares radar data from two different sources: CReSIS and UTIG. It performs spatial matching of the datasets and analyzes the SNR values to evaluate the consistency and reliability of radar data across different sources.

### **3. `data_scrapper.py`**

**Description:**  
This script automates the process of scraping radar data from the [CReSIS data repository](https://data.cresis.ku.edu/data/rds/). It downloads `.csv` and `.mat` files and saves them into a user-defined directory, ensuring reliable and uninterrupted data collection with built-in error handling and retry mechanisms.

### **4. `raw_to_snr`**

**Description:**  
This script processes radar data from various directories, extracting SNR values using the snrfinder function. It saves the combined data as snr_data.csv in a specified folder. This script is designed to be flexible and adaptable for handling large volumes of radar data.

### **5. `plotter`**

**Description:**
This script loads the SNR data from a CSV file generated by raw_to_snr.py and visualizes it through scatter plots. The tool allows for easy interpretation of SNR distribution across different geographical coordinates, aiding in the analysis of radar data quality.
